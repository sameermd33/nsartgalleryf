<form id="orderForm">
  <input type="text" name="date" placeholder="Date" required>
  <input type="text" name="location" placeholder="Location" required>
  <input type="text" name="customer_name" placeholder="Customer Name" required>
  <input type="text" name="customer_phone" placeholder="Phone" required>
  <input type="text" name="expected_delivery_date" placeholder="Delivery Date" required>
  <input type="text" name="artwork_name" placeholder="Artwork Name" required>
  <input type="number" name="advance_payment" placeholder="Advance Payment" required>
  <input type="number" name="pending_payment" placeholder="Pending Payment" required>
  <button type="submit">Submit</button>
</form>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbw1d_JGF2bihOD_Qp_XSoNfjh82nfQuXbVyGHnul5deCtn7_W4bfLIrzcQIYrdqOvCZrA/exec";
const AUTH_KEY = "sunkara";

document.getElementById("orderForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const formData = new FormData(e.target);
  const record = {};
  formData.forEach((value, key) => {
    record[key] = value;
  });

  try {
    const res = await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        auth: AUTH_KEY,
        action: "append",
        record
      })
    });

    const data = await res.json();
    if (data.success) {
      alert("Row added successfully!");
      e.target.reset();
    } else {
      alert("Error: " + data.error);
    }
  } catch (err) {
    console.error("Request failed", err);
    alert("Something went wrong. Check console for details.");
  }
});
</script>
